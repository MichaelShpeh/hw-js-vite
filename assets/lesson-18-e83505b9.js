import"./modulepreload-polyfill-3cfb730f.js";import{H as f}from"./handlebars-aa0ac26f.js";const h='<li class="student-item" data-index="{{_index}}"><h2 class="student-title">Новина №{{addOne _index}}</h2><div class="student-text"><p>Автор:&nbsp;{{author}}</p><p>Заголовок:&nbsp;{{title}}</p><p>Опис:&nbsp;{{description}}</p><p>Вміст:&nbsp;{{content}}</p></div><div class="student-actions"><button class="edit-btn" data-index="{{_index}}">Edit</button><button class="delete-btn" data-index="{{_index}}">Delete</button></div></li>';//! імпортування бібліотеки HandeBars
f.registerHelper("addOne",function(t){return t+1});const b=f.compile(h);//! знаходимо всі елементи з розмітки
const u=document.querySelector(".backdrop"),L=document.querySelector(".confirm-button"),v=document.querySelector(".delete-button"),l=document.getElementById("student-info-form"),c=document.querySelector(".news-list"),y=document.querySelector(".buttonOpn"),m=document.querySelector(".backdrop-1"),x=document.querySelector(".formCloseBtn"),p=document.querySelector(".backdrop-edit"),i=document.getElementById("edit-student-form");let s=[];const E="http://localhost:3000/articles";//! завантажуємо дані з сервера
fetch(E).then(function(t){if(!t.ok)throw new Error("Помилка при завантаженні даних");return t.json()}).then(function(t){s=(Array.isArray(t)?t:t.articles).map(function(n,a){return{_index:a,author:n.author||"Невідомо",title:n.title||"Без назви",description:n.description||"Немає опису",content:n.content||"—"}}),r(s)}).catch(function(t){console.error("Помилка завантаження:",t)});//! відкриття модалки для додавання
y.addEventListener("click",function(){m.classList.remove("is-hidden")});x.addEventListener("click",function(){m.classList.add("is-hidden")});//! додаємо статтю/студента вручну
l.addEventListener("submit",function(t){t.preventDefault();try{const e=new FormData(l),n=Object.fromEntries(e.entries());s.push(n),updateLocalStorage(),r(s),l.reset(),m.classList.add("is-hidden")}catch(e){console.error(e)}});//! функція яка рендерить список
function r(t){c.innerHTML="",t.forEach((e,n)=>{e._index=n;const a=b(e);c.insertAdjacentHTML("beforeend",a)})}//! видалення
let d=null;c.addEventListener("click",function(t){if(t.target.classList.contains("delete-btn")){const e=parseInt(t.target.dataset.index,10);if(isNaN(e))return;d=e,u.classList.remove("is-hidden")}});L.addEventListener("click",()=>{d!==null&&(s.splice(d,1),r(s),d=null),u.classList.add("is-hidden")});v.addEventListener("click",()=>{d=null,u.classList.add("is-hidden")});//! редагування
let o=null;c.addEventListener("click",t=>{if(t.target.classList.contains("edit-btn")){const e=parseInt(t.target.dataset.index,10);if(isNaN(e)||!s[e])return;const n=s[e];o=e,i.elements.author.value=n.author,i.elements.title.value=n.title,i.elements.description.value=n.description,i.elements.content.value=n.content,p.classList.remove("is-hidden")}});i.addEventListener("submit",t=>{t.preventDefault();try{const e=new FormData(i),n=Object.fromEntries(e.entries());o!==null&&(s[o]=n,r(s))}catch(e){console.error(e)}finally{i.reset(),p.classList.add("is-hidden"),o=null}});i.querySelector(".cancel-edit-modal").addEventListener("click",()=>{i.reset(),p.classList.add("is-hidden"),o=null});
