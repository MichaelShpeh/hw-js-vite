import"./modulepreload-polyfill-3cfb730f.js";import{H as v}from"./handlebars-aa0ac26f.js";const k='<li class="student-item" data-index="{{_index}}"><h2 class="student-title">Новина №{{addOne _index}}</h2><div class="student-text"><p>Автор:&nbsp;{{author}}</p><p>Заголовок:&nbsp;{{title}}</p><p>Опис:&nbsp;{{description}}</p><p>Вміст:&nbsp;{{content}}</p></div><div class="student-actions"><button class="edit-btn" data-index="{{_index}}">Edit</button><button class="delete-btn" data-index="{{_index}}">Delete</button></div></li>';//! імпортування бібліотеки HandeBars
v.registerHelper("addOne",function(n){return n+1});const B=v.compile(k);//! знаходимо всі елементи з розмітки
const f=document.querySelector(".backdrop"),S=document.querySelector(".confirm-button"),q=document.querySelector(".delete-button"),a=document.getElementById("news-info-form"),d=document.querySelector(".news-list"),P=document.querySelector(".buttonOpn"),g=document.querySelector(".backdrop-1"),w=document.querySelector(".formCloseBtn"),h=document.querySelector(".backdrop-edit"),s=document.getElementById("edit-news-form"),I=document.getElementById("fetch"),_=document.querySelector(".per-page"),$=document.querySelector(".page"),N=document.querySelector(".prev-button"),D=document.querySelector(".next-button");document.getElementById("news-num");const O=document.getElementById("page-num");document.getElementById("total-pages");let L=1,o=[];const m="http://localhost:3000/",p="articles?";let y;function u(){return y=_.value||5}function H(){return Number($.value)}//! завантажуємо дані з сервера
function j(){const n=u(),e=H();console.log(e),fetch(`${m}${p}_page=${e}&_limit=${n}`).then(function(t){if(!t.ok)throw new Error("Помилка при завантаженні даних");return t.json()}).then(t=>{console.log(t),o=(Array.isArray(t)?t:[]).map((i,x)=>({_index:x,author:i.author||"Невідомо",title:i.title||"Без назви",description:i.description||"Немає опису",content:i.content||"—"})),l(o);const E=u();O.textContent=e,console.log(u()),console.log(`${m}${p}_page=${L}&_limit=${E}`)}).catch(function(t){console.error("Помилка завантаження:",t)})}console.log(`${m}${p}_page=${L}&_limit=${y}`);//! відкриття модалки для додавання
P.addEventListener("click",function(){g.classList.remove("is-hidden")});w.addEventListener("click",function(){g.classList.add("is-hidden")});//! додаємо статтю/студента вручну
a.addEventListener("submit",function(n){n.preventDefault();try{const e=new FormData(a),t=Object.fromEntries(e.entries());o.push(t),updateLocalStorage(),l(o),a.reset(),g.classList.add("is-hidden")}catch(e){console.error(e)}});//! функція яка рендерить список
function l(n){d.innerHTML="",n.forEach((e,t)=>{e._index=t;const b=B(e);d.insertAdjacentHTML("beforeend",b)})}//! видалення
let c=null;d.addEventListener("click",function(n){if(n.target.classList.contains("delete-btn")){const e=parseInt(n.target.dataset.index,10);if(isNaN(e))return;c=e,f.classList.remove("is-hidden")}});S.addEventListener("click",()=>{c!==null&&(o.splice(c,1),l(o),c=null),f.classList.add("is-hidden")});q.addEventListener("click",()=>{c=null,f.classList.add("is-hidden")});//! редагування
let r=null;d.addEventListener("click",n=>{if(n.target.classList.contains("edit-btn")){const e=parseInt(n.target.dataset.index,10);if(isNaN(e)||!o[e])return;const t=o[e];r=e,s.elements.author.value=t.author,s.elements.title.value=t.title,s.elements.description.value=t.description,s.elements.content.value=t.content,h.classList.remove("is-hidden")}});s.addEventListener("submit",n=>{n.preventDefault();try{const e=new FormData(s),t=Object.fromEntries(e.entries());r!==null&&(o[r]=t,l(o))}catch(e){console.error(e)}finally{s.reset(),h.classList.add("is-hidden"),r=null}});s.querySelector(".cancel-edit-modal").addEventListener("click",()=>{s.reset(),h.classList.add("is-hidden"),r=null});I.addEventListener("click",j);N.addEventListener("click",A);D.addEventListener("click",F);function A(){}function F(){}
