import"./modulepreload-polyfill-3cfb730f.js";import{H as v}from"./handlebars-aa0ac26f.js";const y=`<li class="student-item" data-index="{{_index}}"><h2 class="student-title">Студент №{{addOne _index}}</h2><div class="student-text"><p>Ім'я:&nbsp;{{name}}</p><p>Прізвище:&nbsp;{{second-name}}</p><p>Вік:&nbsp;{{age}}</p><p>Курс:&nbsp;{{course}}</p><p>Факультет:&nbsp;{{faculty}}</p></div><div class="student-actions"><button class="edit-btn" data-index="{{_index}}">Edit</button><button class="delete-btn" data-index="{{_index}}">Delete</button></div></li>`;//! імпортування бібліотеки HandeBars
v.registerHelper("addOne",function(e){return e+1});const L=v.compile(y);//! знаходимо всі елементи з розмітки
const g=document.querySelector(".backdrop"),S=document.querySelector(".confirm-button"),h=document.querySelector(".delete-button"),u=document.getElementById("student-info-form"),l=document.getElementById("students-list"),E=document.querySelector(".buttonOpn"),b=document.querySelector(".backdrop-1"),x=document.querySelector(".formCloseBtn"),m=document.querySelector(".backdrop-edit"),s=document.getElementById("edit-student-form");document.querySelector(".cancel-edit-modal");E.addEventListener("click",function(){b.classList.remove("is-hidden")});x.addEventListener("click",function(){b.classList.add("is-hidden")});let a=[];if(localStorage.getItem("students"))try{const e=localStorage.getItem("students");a=JSON.parse(e),o(a)}catch(e){console.error("Помилка парсингу localStorage:",e)}else{a=[];const e=JSON.stringify(a);localStorage.setItem("students",e),o(a)}//! додаємо студента
u.addEventListener("submit",function(e){e.preventDefault();try{const t=new FormData(u),n=Object.fromEntries(t.entries());a.push(n),f(),o(localStorage.getItem("students")),u.reset(),b.classList.add("is-hidden")}catch(t){console.error(t)}});//! функція яка додає студента в список
function o(e){l.innerHTML='<li class="item">Список студентів:</li>',e.forEach((t,n)=>{t._index=n;try{const r=L(t);l.insertAdjacentHTML("beforeend",r)}catch(r){console.error(r)}})}//! оновлюємо localstorage
function f(){try{const e=JSON.stringify(a);localStorage.setItem("students",e)}catch(e){console.error("Помилка JSON.stringify:",e)}}//! відкриття модалки
let c=null;l.addEventListener("click",function(e){if(e.target.classList.contains("delete-btn")){const t=parseInt(e.target.dataset.index,10);if(isNaN(t))return;c=t,g.classList.remove("is-hidden")}});//! підтвердити видалення
S.addEventListener("click",()=>{c!==null&&(a.splice(c,1),f(),o(localStorage.getItem("students")),c=null),g.classList.add("is-hidden")});//! скасувати видалення
h.addEventListener("click",()=>{c=null,g.classList.add("is-hidden")});//! редагування студента
let d=null;l.addEventListener("click",e=>{if(e.target.classList.contains("edit-btn")){const t=parseInt(e.target.dataset.index,10);if(isNaN(t)||!a[t])return;const n=a[t];d=t,s.elements.name.value=n.name,s.elements["second-name"].value=n["second-name"],s.elements.age.value=n.age,s.elements.course.value=n.course,s.elements.faculty.value=n.facult,s.addEventListener("submit",r=>{r.preventDefault();try{const p=new FormData(s),i=Object.fromEntries(p.entries());i.age=Number(i.age),console.log("updatedStudent:",i),a[d]=i,f(),o(localStorage.getItem("students"))}catch(p){console.error(p)}finally{s.reset(),m.classList.add("is-hidden"),d=null}}),s.querySelector(".cancel-edit-modal").addEventListener("click",()=>{u.id="student-info-form",m.classList.add("is-hidden")})}});l.addEventListener("click",e=>{if(e.target.classList.contains("edit-btn")){const t=parseInt(e.target.dataset.index,10);if(isNaN(t)||!a[t])return;const n=a[t];d=t,s.elements.name.value=n.name,s.elements["second-name"].value=n["second-name"],s.elements.age.value=n.age,s.elements.course.value=n.course,s.elements.faculty.value=n.faculty,m.classList.remove("is-hidden")}});//! підтвердження змінення
s.addEventListener("submit",e=>{e.preventDefault();try{const t=new FormData(s),n=Object.fromEntries(t.entries());a[d]=n,f(),o(localStorage.getItem("students"))}catch(t){console.error(t)}finally{s.reset(),m.classList.add("is-hidden"),d=null}});
