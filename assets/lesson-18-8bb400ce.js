import"./modulepreload-polyfill-3cfb730f.js";import{H as b}from"./handlebars-aa0ac26f.js";const y='<li class="student-item" data-index="{{_index}}"><h2 class="student-title">Новина №{{addOne _index}}</h2><div class="student-text"><p>Автор:&nbsp;{{author}}</p><p>Заголовок:&nbsp;{{title}}</p><p>Опис:&nbsp;{{description}}</p><p>Вміст:&nbsp;{{content}}</p></div><div class="student-actions"><button class="edit-btn" data-index="{{_index}}">Edit</button><button class="delete-btn" data-index="{{_index}}">Delete</button></div></li>';//! імпортування бібліотеки HandeBars
b.registerHelper("addOne",function(t){return t+1});const g=b.compile(y);//! знаходимо всі елементи з розмітки
const p=document.querySelector(".backdrop"),E=document.querySelector(".confirm-button"),x=document.querySelector(".delete-button"),u=document.getElementById("student-info-form"),i=document.querySelector(".news-list"),k=document.querySelector(".buttonOpn"),f=document.querySelector(".backdrop-1"),S=document.querySelector(".formCloseBtn"),h=document.querySelector(".backdrop-edit"),o=document.getElementById("edit-student-form"),B=document.getElementById("fetch"),q=document.querySelector(".per-page"),L=document.querySelector(".page"),I=document.querySelector(".prev-button"),P=document.querySelector(".next-button");document.getElementById("news-num");const w=document.getElementById("page-num"),D=document.getElementById("total-pages");let s=[];const _="http://localhost:3000/",N="articles?",O=q.value;//! завантажуємо дані з сервера
function v(){fetch(`${_}${N}_page=${c}&limit=${O}`).then(function(t){if(!t.ok)throw new Error("Помилка при завантаженні даних");return t.json()}).then(t=>{s=(Array.isArray(t.data)?t.data:[]).map((n,l)=>({_index:l,author:n.author||"Невідомо",title:n.title||"Без назви",description:n.description||"Немає опису",content:n.content||"—"})),a(s),m=t.pages,D.textContent=m,w.textContent=c}).catch(function(t){console.error("Помилка завантаження:",t)})}//! відкриття модалки для додавання
k.addEventListener("click",function(){f.classList.remove("is-hidden")});S.addEventListener("click",function(){f.classList.add("is-hidden")});//! додаємо статтю/студента вручну
u.addEventListener("submit",function(t){t.preventDefault();try{const e=new FormData(u),n=Object.fromEntries(e.entries());s.push(n),updateLocalStorage(),a(s),u.reset(),f.classList.add("is-hidden")}catch(e){console.error(e)}});//! функція яка рендерить список
function a(t){i.innerHTML="",t.forEach((e,n)=>{e._index=n;const l=g(e);i.insertAdjacentHTML("beforeend",l)})}//! видалення
let d=null;i.addEventListener("click",function(t){if(t.target.classList.contains("delete-btn")){const e=parseInt(t.target.dataset.index,10);if(isNaN(e))return;d=e,p.classList.remove("is-hidden")}});E.addEventListener("click",()=>{d!==null&&(s.splice(d,1),a(s),d=null),p.classList.add("is-hidden")});x.addEventListener("click",()=>{d=null,p.classList.add("is-hidden")});//! редагування
let r=null;i.addEventListener("click",t=>{if(t.target.classList.contains("edit-btn")){const e=parseInt(t.target.dataset.index,10);if(isNaN(e)||!s[e])return;const n=s[e];r=e,o.elements.author.value=n.author,o.elements.title.value=n.title,o.elements.description.value=n.description,o.elements.content.value=n.content,h.classList.remove("is-hidden")}});o.addEventListener("submit",t=>{t.preventDefault();try{const e=new FormData(o),n=Object.fromEntries(e.entries());r!==null&&(s[r]=n,a(s))}catch(e){console.error(e)}finally{o.reset(),h.classList.add("is-hidden"),r=null}});o.querySelector(".cancel-edit-modal").addEventListener("click",()=>{o.reset(),h.classList.add("is-hidden"),r=null});let m=1,c=1;B.addEventListener("click",v);I.addEventListener("click",H);P.addEventListener("click",j);function H(){c<=1||(c--,L.value=c,v())}function j(){c>=m||(c++,L.value=c,v())}
