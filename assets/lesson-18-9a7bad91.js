import"./modulepreload-polyfill-3cfb730f.js";import{H as k}from"./handlebars-aa0ac26f.js";const P='<li class="student-item" data-index="{{_index}}"><h2 class="student-title">Новина №{{addOne _index}}</h2><div class="student-text"><p>Автор:&nbsp;{{author}}</p><p>Заголовок:&nbsp;{{title}}</p><p>Опис:&nbsp;{{description}}</p><p>Вміст:&nbsp;{{content}}</p></div><div class="student-actions"><button class="edit-btn" data-index="{{_index}}">Edit</button><button class="delete-btn" data-index="{{_index}}">Delete</button></div></li>';//! імпортування бібліотеки HandeBars
k.registerHelper("addOne",function(t){return t+1});const q=k.compile(P);//! знаходимо всі елементи з розмітки
const b=document.querySelector(".backdrop"),w=document.querySelector(".confirm-button"),I=document.querySelector(".delete-button"),m=document.getElementById("news-info-form"),a=document.querySelector(".news-list"),_=document.querySelector(".buttonOpn"),L=document.querySelector(".backdrop-1"),$=document.querySelector(".formCloseBtn"),y=document.querySelector(".backdrop-edit"),c=document.getElementById("edit-news-form"),N=document.getElementById("fetch"),D=document.querySelector(".per-page"),E=document.querySelector(".page"),O=document.querySelector(".prev-button"),H=document.querySelector(".next-button"),j=document.getElementById("news-num"),A=document.getElementById("page-num"),C=document.getElementById("total-pages");let o=1,s=[];const g="http://localhost:3000/",h="articles?";let S;function p(){return S=D.value||5}function F(){return Number(E.value)}//! завантажуємо дані з сервера
function x(){const t=p();o=F(),fetch(`${g}${h}_page=${o}&_limit=${t}`).then(function(e){if(!e.ok)throw new Error("Помилка при завантаженні даних");return e.json()}).then(e=>{console.log(e),s=(Array.isArray(e)?e:[]).map((l,B)=>({_index:B,author:l.author||"Невідомо",title:l.title||"Без назви",description:l.description||"Немає опису",content:l.content||"—"})),u(s),f=e.totalResults||0;const d=p();v=Math.ceil(f/d),C.textContent=v,A.textContent=o,j.textContent=f,console.log(p()),console.log(`${g}${h}_page=${o}&_limit=${d}`)}).catch(function(e){console.error("Помилка завантаження:",e)})}console.log(`${g}${h}_page=${o}&_limit=${S}`);//! відкриття модалки для додавання
_.addEventListener("click",function(){L.classList.remove("is-hidden")});$.addEventListener("click",function(){L.classList.add("is-hidden")});//! додаємо статтю/студента вручну
m.addEventListener("submit",function(t){t.preventDefault();try{const e=new FormData(m),n=Object.fromEntries(e.entries());s.push(n),updateLocalStorage(),u(s),m.reset(),L.classList.add("is-hidden")}catch(e){console.error(e)}});//! функція яка рендерить список
function u(t){a.innerHTML="",t.forEach((e,n)=>{e._index=n;const d=q(e);a.insertAdjacentHTML("beforeend",d)})}//! видалення
let r=null;a.addEventListener("click",function(t){if(t.target.classList.contains("delete-btn")){const e=parseInt(t.target.dataset.index,10);if(isNaN(e))return;r=e,b.classList.remove("is-hidden")}});w.addEventListener("click",()=>{r!==null&&(s.splice(r,1),u(s),r=null),b.classList.add("is-hidden")});I.addEventListener("click",()=>{r=null,b.classList.add("is-hidden")});//! редагування
let i=null;a.addEventListener("click",t=>{if(t.target.classList.contains("edit-btn")){const e=parseInt(t.target.dataset.index,10);if(isNaN(e)||!s[e])return;const n=s[e];i=e,c.elements.author.value=n.author,c.elements.title.value=n.title,c.elements.description.value=n.description,c.elements.content.value=n.content,y.classList.remove("is-hidden")}});c.addEventListener("submit",t=>{t.preventDefault();try{const e=new FormData(c),n=Object.fromEntries(e.entries());i!==null&&(s[i]=n,u(s))}catch(e){console.error(e)}finally{c.reset(),y.classList.add("is-hidden"),i=null}});c.querySelector(".cancel-edit-modal").addEventListener("click",()=>{c.reset(),y.classList.add("is-hidden"),i=null});let f=0,v=1;N.addEventListener("click",x);O.addEventListener("click",M);H.addEventListener("click",T);function M(){o<=1||(o--,E.value=o,x())}function T(){o>=v||(o++,E.value=o,x())}
